
@{
    ViewBag.Title = "Controls";
}

<h2>Controls</h2>

<div class="row">
    <div class="col-md-4">
        <input id="inHours" type="number" name="hours" /> hours
        <input id="inMinutes" type="number" name="minutes" /> minutes
        <input id="inSeconds" type="number" name="seconds" /> seconds
        <input id="submitTime" type="button" name="Set Countdown" value="Set Countdown" />
        <input id="pause" type="button" value="Pause" />
        <input id="resume" type="button" value="Resume" />
    </div>
    <div class="col-md-4">
        <h2>Time Remaining:</h2>
        <h3 id="counter"></h3>
    </div>
</div>

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.0.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.
            var chat = $.connection.timerHub;

            //// Create a function that the hub can call back to display messages.
            //chat.client.addNewMessageToPage = function (name, message) {
            //    // Add the message to the page.
            //    $('#discussion').append('<li><strong>' + htmlEncode(name)
            //        + '</strong>: ' + htmlEncode(message) + '</li>');
            //};

            chat.client.setTimeRemaining = function (hours, minutes, seconds) {
                $('#counter').html(ToDoubleDigits(hours) + ":" + ToDoubleDigits(minutes) + ":" + ToDoubleDigits(seconds));
            };


            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#submitTime').click(function () {
                    // Call the SendSetCountdownTime method on the hub. 
                    chat.server.sendSetCountdownTime($("#inHours").val(), $("#inMinutes").val(), $("#inSeconds").val());
                });
                $('#pause').click(function () {
                    chat.server.pauseTimer();
                })
                $('#resume').click(function () {
                    chat.server.resumeTimer();
                })
            });


        });

        function ToDoubleDigits(number) {
            if (number < 10) {
                return "0" + number;
            } else {
                return number;
            }
        }
    </script>
}